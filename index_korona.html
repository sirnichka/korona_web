<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Количество заражённых COVID-19 в мире</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <script src="https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.css" rel="stylesheet" />

</head>
<body>
    <style>

        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
    <style>



        .white_source {
            margin: 30px 30px 0px;
            text-align: left;
            font: 30px 'RedRing', Arial, Helvetica, sans-serif;
            color: #E0FFFF;
            padding: 10px;
            position: absolute;
            bottom: 0px;
            z-index: 1;
        }

        .legend {
            margin: 30px 30px 30px;
            text-align: left;
            border-radius: 3px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            font: 30px 'RedRing', Arial, Helvetica, sans-serif;
            color: #E0FFFF;
            padding: 10px;
            position: absolute;
            bottom: 100px;
            z-index: 1;
        }

        .red {
            margin: 30px 30px 30px;
            text-align: left;
            border-radius: 3px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            font: 30px 'RedRing', Arial, Helvetica, sans-serif;
            color: #fe0505;
            padding: 10px;
            position: absolute;
            bottom: 20px;
            z-index: 1;
        }
    </style>

    <style>

        .mapboxgl-popup {
            max-width: 400px;
            font: 20px 'RedRing', Arial, Helvetica, sans-serif;
            color: #E0FFFF;
        }

        .mapboxgl-popup-content {
            background-color: rgba(1,1,1,0.3);
        }

        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>


    <div id="map"></div>

    <div class="legend">
        <h3>Количество заражённых COVID-19 в мире</h3>
    </div>

    <div class="red">
        <h2>41 9302</h2>
    </div>

    <div class="white_source">
        <h6>Данные на 25 марта 2020</h6>
    </div>



    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoiaXJhZCIsImEiOiJjanVjdTE0YzgwaXhtNDNwZG9sNWt5eGl3In0.51FlFPCOJBznfpPRscP05A';
        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/irad/ck87k1rwe0xpk1inmngyd5vow',
            center: [20, 0],
            minZoom: 2,
            maxZoom: 3,
            zoom: 1
        });

        map.on('load', function () {

            map.addSource('blockooo', {
                type: 'vector',
                url: 'mapbox://irad.11f3x5jl'
            });

            map.addLayer({
                'id': 'blocks',
                'type': 'fill',
                'source': 'blockooo',
                'source-layer': 'test-53n96m',
                'paint': {
                    'fill-color': [
                        'interpolate',
                        ['linear'],
                        ['get', 'Cases_2503'],
                        0,
                        '#43393b',
                        1,
                        '#5d4345',
                        20,
                        '#a15b5c',
                        300,
                        '#c16364',
                        4500,
                        '#eb5a5a',
                        81218,
                        '#fe0505'
                    ],
                    'fill-opacity': 0.75
                }
            });

            map.addLayer({
                'id': 'blocksx',
                'type': 'symbol',
                'source': 'blockooo',
                'source-layer': 'test-53n96m',
                paint: {
                    "text-color": "#ffffff"
                }
            });

            map.setLayoutProperty('blocksx', 'text-field', [
                'format',
                ['get', 'alpha_3'],
                {
                    'font-scale': 1.0,
                },

            ]);

            map.setPaintProperty('blocksx', 'text-opacity', .6);

            var popup = new mapboxgl.Popup({
                closeButton: false,
                closeOnClick: false

            });

            map.on('mousemove', 'blocks', function (e) {

                map.getCanvas().style.cursor = 'pointer';

                var coordinates = e.features[0].geometry.coordinates.slice();
                var description = e.features[0].properties["corona_c_1"] + " <br/>"
                var description2 = e.features[0].properties["Cases_2503"]
                if (description2 == 1000) { description2 = 'no data' }
                popup.setLngLat(e.lngLat).setHTML(description + description2).addTo(map);

            });

            map.on('mouseleave', 'blocks', function () {
                map.getCanvas().style.cursor = '';
                popup.remove();
            });


        });


    </script>

</body>
</html>
